(self.webpackChunkchatsubo=self.webpackChunkchatsubo||[]).push([[224],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return c},kt:function(){return m}});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var u=r.createContext({}),l=function(e){var n=r.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},c=function(e){var n=l(e.components);return r.createElement(u.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},d=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,u=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=l(t),m=o,k=d["".concat(u,".").concat(m)]||d[m]||p[m]||a;return t?r.createElement(k,i(i({ref:n},c),{},{components:t})):r.createElement(k,i({ref:n},c))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=d;var s={};for(var u in n)hasOwnProperty.call(n,u)&&(s[u]=n[u]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var l=2;l<a;l++)i[l]=t[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}d.displayName="MDXCreateElement"},356:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return s},contentTitle:function(){return u},metadata:function(){return l},toc:function(){return c},default:function(){return d}});var r=t(2122),o=t(9756),a=(t(7294),t(3905)),i=["components"],s={},u="Quickstart",l={unversionedId:"Introduction/quickstart",id:"Introduction/quickstart",isDocsHomePage:!1,title:"Quickstart",description:"D\xe9marrage",source:"@site/docs/10-Introduction/20-quickstart.md",sourceDirName:"10-Introduction",slug:"/Introduction/quickstart",permalink:"/docs/Introduction/quickstart",editUrl:"https://github.com/chatsuboctf/chatsubo/docs/10-Introduction/20-quickstart.md",version:"current",sidebarPosition:20,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Pr\xe9requis",permalink:"/docs/Introduction/requirements"},next:{title:"Introduction",permalink:"/docs/Providers/index"}},c=[{value:"D\xe9marrage",id:"d\xe9marrage",children:[]},{value:"Configuration",id:"configuration",children:[{value:"VPN",id:"vpn",children:[]},{value:"Proxmox",id:"proxmox",children:[]},{value:"Docker",id:"docker",children:[]}]},{value:"Proxmox",id:"proxmox-1",children:[]},{value:"Docker",id:"docker-1",children:[]}],p={toc:c};function d(e){var n=e.components,t=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"quickstart"},"Quickstart"),(0,a.kt)("h2",{id:"d\xe9marrage"},"D\xe9marrage"),(0,a.kt)("p",null,"La mani\xe8re la plus simple de d\xe9ployer Chatsubo est d'utiliser le fichier docker-compose fourni avec l'application :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'git clone https://github.com/chatsuboctf/chatsubo\nvim config/chatsubo.yml  #] Update Chatsubo\'s configuration, cf. "Configuration"\ndocker-compose up --build -d\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Il est n\xe9cessaire que docker-compose puisse lire le dossier contenant les donn\xe9es de la base MySQL pour d\xe9marrer. Si vous rencontrez une erreur de permission au lancement de Chatsubo, ces deux options sont possibles :"),(0,a.kt)("ul",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ul"},"Changer les permissions du dossier ",(0,a.kt)("inlineCode",{parentName:"li"},"docker/.data"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"sudo chmod -R 744 ./docker/.data")," "))),(0,a.kt)("li",{parentName:"ul"},"Lancer docker avec les droits adiministrateurs",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"sudo docker-compose up --build -d")))))),(0,a.kt)("h2",{id:"configuration"},"Configuration"),(0,a.kt)("p",null,"Avant de lancer la plateforme, il est n\xe9cessaire de lui donner toutes les informations n\xe9cessaires afin d'\xeatre en mesure de communiquer avec les providers avec lesquels on souhaite interagir. "),(0,a.kt)("p",null,"Ces donn\xe9es sont regroup\xe9es dans le fichier de configuration ",(0,a.kt)("inlineCode",{parentName:"p"},"config/chatsubo.yml"),"."),(0,a.kt)("p",null,"Il est recommand\xe9 de copier le fichier d'exemple (",(0,a.kt)("inlineCode",{parentName:"p"},"cp config/chatsubo.sample.yml config/chatsubo.yml"),") puis de changer les valeurs en fonction de l'infrastucture cibl\xe9e."),(0,a.kt)("p",null,"Ci-dessous un exemple de configuration pour un provider Docker et un pont VPN h\xe9berg\xe9s tous deux \xe0 l'adresse chatsubo.wz :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'providers:\n  # PVE providers list\n  pve:\n   remote_pve:  # This can be anything but must be kept unique\n    api:\n      user: "api@pve"\n      host: "X.X.X.X"\n      port: 8006\n      token:\n        name: "changeme"\n        value: "changeme"\n    realms:\n      - "chatsubo.wz"\n\n  # Docker providers list\n  docker:\n   remote_docker:  # This can be anything but must be kept unique\n     dockerfiles_root: "/var/chatsubo/docker"\n     limits:\n       memory: "256m"\n     flag_prefix: "FLAG"\n     api:\n       host: "chatsubo.wz"\n       port: 2376\n       client:\n         cert: "config/providers/docker/chatsubo.wz/cert.pem"\n         key: "config/providers/docker/chatsubo.wz/key.pem"\n         ca: "config/providers/docker/chatsubo.wz/ca.pem"\n     realms:\n       - "chatsubo.wz"\n\nvpns:\n - realm: "chatsubo.wz"\n   url: "http://chatsubo.wz:7474"\n   token: "CHANGEMECHANGEMECHANGEMECHANGEMECHANGEMECHANGEMECHANGEMECHANGEMECHANGEME"\n\n')),(0,a.kt)("h3",{id:"vpn"},"VPN"),(0,a.kt)("p",null,"Il est possible de configurer plusieurs ponts VPN. Chaque pont VPN correspond \xe0 un ",(0,a.kt)("inlineCode",{parentName:"p"},"realm"),". Ces realms seront par la suite attach\xe9s aux diff\xe9rents providers."),(0,a.kt)("p",null,"De cette mani\xe8re :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Un joueur peut acc\xe9der aux instances g\xe9r\xe9es par plusieurs providers depuis un m\xeame ",(0,a.kt)("inlineCode",{parentName:"li"},"realm")," de mani\xe8re transparente"),(0,a.kt)("li",{parentName:"ul"},"Un m\xeame challenge peut \xeatre instanci\xe9 dans plusieurs ",(0,a.kt)("inlineCode",{parentName:"li"},"realms"),"  diff\xe9rents")),(0,a.kt)("p",null,"Ainsi, lorsqu'un pont VPN arrive \xe0 saturation, il est possible de monter un nouveau pont pour ouvrir un nouveau r\xe9seau de jeu et merttre \xe0 disposition de nouveaux acc\xe8s."),(0,a.kt)("h4",{id:"cas-concret"},"Cas concret"),(0,a.kt)("p",null,"Dans le sc\xe9nario suivant : "),(0,a.kt)("p",null,"250 joueurs sont actifs via le pont VPN accessible via ",(0,a.kt)("em",{parentName:"p"},"one.chatsubo.wz")," et les 255 acc\xe8s pr\xe9-g\xe9n\xe9r\xe9s du portail WireGuard sur le sous-r\xe9seau 10.10.10.0/24 arrivent bient\xf4t \xe0 saturation."),(0,a.kt)("p",null,"Dans cette situation, il suffit de d\xe9ployer, sur la m\xeame machine, une nouvelle instance de ",(0,a.kt)("inlineCode",{parentName:"p"},"chatsubo-gate-wg")," configur\xe9e sur le sous-r\xe9seau 10.10.20.0/24 et accessible via le nom de domaine ",(0,a.kt)("em",{parentName:"p"},"second.chatsubo.wz")," pour que 255 nouveaux acc\xe8s soient disponibles aux joueurs via le ",(0,a.kt)("inlineCode",{parentName:"p"},"realm"),' "second.chatsubo.wz".'),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Ne pas oublier d'ajouter la route avec le nouveau sous-r\xe9seau pour que la connexion du joueur puisse \xeatre rout\xe9e vers l'adresse IP que lui donne le VPN."),(0,a.kt)("ul",{parentName:"blockquote"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"sudo ip route add 10.10.20.0/24 via 10.10.10.X")))),(0,a.kt)("h3",{id:"proxmox"},"Proxmox"),(0,a.kt)("p",null,"La configuration de Proxmox ne demande que les informations permettant d'acc\xe9der \xe0 l'API (cf. ",(0,a.kt)("a",{href:"/docs/Introduction/requirements"},"les pr\xe9requis"),")."),(0,a.kt)("h3",{id:"docker"},"Docker"),(0,a.kt)("p",null,"En ce qui concerne Docker, c'est cette fois directement \xe0 la socket Docker que la plateforme va envoyer ses requ\xeates."),(0,a.kt)("p",null,"Puisqu'elle est prot\xe9g\xe9e par une authentification TLS, il est n\xe9cessaire d'indiquer \xe0 Chatsubo o\xf9 se trouvent tous les \xe9l\xe9ments requis pour authentifier ses requ\xeates."),(0,a.kt)("p",null,"Bien qu'ils puissent se trouver n'importe o\xf9 sur la machine, il est recommand\xe9 de d\xe9poser les fichiers dans le dossier pr\xe9vu \xe0 cet effet (",(0,a.kt)("inlineCode",{parentName:"p"},"config/providers/docker/$REALM/"),")."),(0,a.kt)("h2",{id:"proxmox-1"},"Proxmox"),(0,a.kt)("p",null,"Une fois le provider reconnu, il suffit de renseigner les m\xe9tadonn\xe9es des instances que l'ont souhaite exposer dans les ",(0,a.kt)("inlineCode",{parentName:"p"},"Notes")," pour que les joueurs puissent acc\xe9der \xe0 l'instance."),(0,a.kt)("p",null,"Ci-dessous un exemple du minimum n\xe9cessaire :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"chatsubo.template=helloworld\nchatsubo.realm=chatsubo.wz\nchatsubo.address=X.X.X.X\n")),(0,a.kt)("p",null,"Il faudra ensuite enregistrer le template depuis l'interface web et activer la publication pour la rendre accessible."),(0,a.kt)("h2",{id:"docker-1"},"Docker"),(0,a.kt)("p",null,"Les Dockerfile utilis\xe9s pour la cr\xe9ation d'instances \xe0 la vol\xe9e sont envoy\xe9es par la plateforme."),(0,a.kt)("p",null,"Ces fichiers sont stock\xe9es dans le dossier ",(0,a.kt)("inlineCode",{parentName:"p"},"/var/chatsubo/docker/$TEMPLATE"),"."),(0,a.kt)("p",null,"\xc0 l'instar des instances PVE, un minimum d'information est n\xe9cessaire pour que la plateforme puisse servir d'interm\xe9diaire entre le joueur et le challenge."),(0,a.kt)("p",null,"Les m\xe9tadonn\xe9es sont enregistr\xe9es et expos\xe9es gr\xe2ce aux labels. "),(0,a.kt)("p",null,"Ici les informations minimales requises pour une instance Docker :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-Dockerfile"},'LABEL chatsubo.template="helloworld" \\\n      chatsubo.realm="chatsubo.wz" \n')),(0,a.kt)("p",null,"L'absence du label ",(0,a.kt)("inlineCode",{parentName:"p"},"chatsubo.address")," s'explique par l'exposition des IP des conteneurs via la socket Docker : la plateforme a acc\xe8s \xe0 cette information de mani\xe8re autonome et n'a donc pas besoin que l'on la lui indique."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},'Il est possible d\'enregistrer une instance "classique" g\xe9r\xe9e par un provider Docker. Il sera cependant indispensable de renseigner tous les labels n\xe9cessaires \xe0 la main lors de son instanciation.')))}d.isMDXComponent=!0}}]);